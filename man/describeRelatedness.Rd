% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/describeRelatedness.R
\name{describeRelatedness}
\alias{describeRelatedness}
\title{Describe Genetic Relatedness with Textual Labels}
\usage{
describeRelatedness(
  rel_df,
  add_col = "addRel",
  gen1_col = "gen1",
  gen2_col = "gen2",
  sex1_col = "sex1",
  sex2_col = "sex2",
  code_male = 1,
  code_female = 0,
  use_sex = FALSE,
  return_list = FALSE
)
}
\arguments{
\item{rel_df}{A data.frame with columns for pairwise relatedness information.
Required columns: ID1, ID2, addRel (additive relatedness coefficient).
Optional columns: gen1, gen2 (generation numbers), sex1, sex2 (biological sex).}

\item{add_col}{Character. Name of the column containing additive relatedness coefficients.
Default is "addRel".}

\item{gen1_col}{Character. Name of the column containing generation for person 1.
Default is "gen1".}

\item{gen2_col}{Character. Name of the column containing generation for person 2.
Default is "gen2".}

\item{sex1_col}{Character. Name of the column containing sex for person 1.
Default is "sex1".}

\item{sex2_col}{Character. Name of the column containing sex for person 2.
Default is "sex2".}

\item{code_male}{The value used to denote males. Default is 1.}

\item{code_female}{The value used to denote females. Default is 0.}

\item{use_sex}{Logical. If TRUE and sex columns are available, generate sex-specific
relationship labels (e.g., "mother-child" vs "father-child"). Default is FALSE.}

\item{return_list}{Logical. If TRUE, return a list with both the original data and
the relationship descriptions. If FALSE, return a data.frame with an added
"relationship" column. Default is FALSE.}
}
\value{
If \code{return_list = FALSE} (default), returns a data.frame identical to \code{rel_df}
with an additional "relationship" column containing textual descriptions.
If \code{return_list = TRUE}, returns a list with two elements:
\itemize{
\item \code{data}: The original data.frame with the relationship column added
\item \code{relationships}: A character vector of relationship descriptions
}
}
\description{
This function takes a flat/vectorized relatedness matrix and generates textual
descriptions of the genetic relationships based on additive relatedness coefficients
and generation differences.
}
\details{
The function uses the additive relatedness coefficient (\code{addRel}) and generation
difference to infer relationship types. Common relationships and their expected
values are:
\itemize{
\item addRel = 1.0, gen1 == gen2: "self" (same individual)
\item addRel = 0.5, gen1 == gen2: "full siblings"
\item addRel = 0.5, |gen1 - gen2| == 1: "parent-child"
\item addRel = 0.25, gen1 == gen2: "half siblings"
\item addRel = 0.25, |gen1 - gen2| == 1: "aunt/uncle-niece/nephew"
\item addRel = 0.25, |gen1 - gen2| == 2: "grandparent-grandchild"
\item addRel = 0.125, gen1 == gen2: "first cousins"
\item addRel = 0.0625, gen1 == gen2: "second cousins"
\item And relationships with various degrees of removal for cousins
}

When \code{use_sex = TRUE} and sex information is available, parent-child relationships
can be further specified as "mother-child", "father-child", "mother-son",
"mother-daughter", "father-son", or "father-daughter".
}
\examples{
\dontrun{
# Create example relatedness data
rel_data <- data.frame(
  ID1 = c(1, 1, 1, 2),
  ID2 = c(2, 3, 4, 3),
  addRel = c(0.5, 0.25, 0.125, 0.5),
  gen1 = c(1, 1, 1, 2),
  gen2 = c(2, 3, 1, 2)
)

# Get relationship descriptions
described <- describeRelatedness(rel_data)
print(described)

# With sex-specific labels
rel_data$sex1 <- c(0, 0, 1, 1)
rel_data$sex2 <- c(1, 0, 0, 1)
described_sex <- describeRelatedness(rel_data, use_sex = TRUE)
print(described_sex)
}

}

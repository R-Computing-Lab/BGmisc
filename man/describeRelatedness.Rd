% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/describeRelatedness.R
\name{describeRelatedness}
\alias{describeRelatedness}
\title{Describe Genetic Relatedness with Textual Labels}
\usage{
describeRelatedness(
  rel_df,
  ped = NULL,
  personID = "personID",
  sex_col = "sex",
  gen_col = NULL,
  ID1_col = "ID1",
  ID2_col = "ID2",
  add_col = "addRel",
  code_male = 1,
  code_female = 0,
  use_sex = FALSE,
  return_list = FALSE
)
}
\arguments{
\item{rel_df}{A data.frame with columns for pairwise relatedness information.
Required columns: ID1, ID2 (or custom names via \code{ID1_col}/\code{ID2_col}).
Typically produced by \code{\link{com2links}}.}

\item{ped}{Optional data.frame containing pedigree information. If provided, sex
and generation information will be automatically joined. Should contain columns
specified by \code{personID}, \code{sex_col}, and optionally \code{gen_col}.}

\item{personID}{Character. Name of the column in \code{ped} containing person IDs.
Default is "personID".}

\item{sex_col}{Character. Name of the column in \code{ped} containing sex information.
Default is "sex".}

\item{gen_col}{Character. Name of the column in \code{ped} containing generation numbers.
If NULL (default), relationships will be described without generation information.}

\item{ID1_col}{Character. Name of the column in \code{rel_df} for person 1 ID.
Default is "ID1".}

\item{ID2_col}{Character. Name of the column in \code{rel_df} for person 2 ID.
Default is "ID2".}

\item{add_col}{Character. Name of the column containing additive relatedness coefficients.
Default is "addRel".}

\item{code_male}{The value used to denote males in the sex column. Default is 1.}

\item{code_female}{The value used to denote females in the sex column. Default is 0.}

\item{use_sex}{Logical. If TRUE and sex information is available, generate sex-specific
relationship labels (e.g., "mother-child" vs "father-child"). Default is FALSE.}

\item{return_list}{Logical. If TRUE, return a list with both the original data and
the relationship descriptions. If FALSE, return a data.frame with an added
"relationship" column. Default is FALSE.}
}
\value{
If \code{return_list = FALSE} (default), returns a data.frame identical to \code{rel_df}
with an additional "relationship" column containing textual descriptions.
If \code{return_list = TRUE}, returns a list with two elements:
\itemize{
\item \code{data}: The original data.frame with the relationship column added
\item \code{relationships}: A character vector of relationship descriptions
}
}
\description{
This function takes a flat/vectorized relatedness matrix (as produced by
\code{\link{com2links}}) and generates textual descriptions of the genetic
relationships based on additive relatedness coefficients and generation differences.
}
\details{
The function uses the additive relatedness coefficient (\code{addRel}) and generation
difference to infer relationship types. Common relationships and their expected
values are:
\itemize{
\item addRel = 1.0, same generation: "self" (same individual)
\item addRel = 0.5, same generation: "full siblings"
\item addRel = 0.5, 1 generation apart: "parent-child"
\item addRel = 0.25, same generation: "half siblings"
\item addRel = 0.25, 1 generation apart: "aunt/uncle-niece/nephew"
\item addRel = 0.25, 2 generations apart: "grandparent-grandchild"
\item addRel = 0.125, same generation: "first cousins"
\item addRel = 0.0625, same generation: "second cousins"
\item And relationships with various degrees of removal for cousins
}

When \code{use_sex = TRUE} and sex information is available (either from \code{ped}
or already present in \code{rel_df}), parent-child relationships can be further
specified as "mother-child", "father-child", "mother-son", "mother-daughter",
"father-son", or "father-daughter". Similar sex-specific labels are provided for
grandparent and avuncular relationships.
}
\examples{
\dontrun{
# Basic usage with com2links output
library(BGmisc)
data(potter)

# Compute additive relatedness matrix
add_matrix <- ped2add(potter, sparse = FALSE)

# Convert to pairwise format
rel_pairs <- com2links(ad_ped_matrix = add_matrix, writetodisk = FALSE)

# Describe relationships (without generation info)
described <- describeRelatedness(rel_pairs)
head(described)

# With pedigree for sex-specific labels
# (assumes potter has a 'gen' column for generation)
described_sex <- describeRelatedness(rel_pairs, ped = potter, 
                                     use_sex = TRUE, gen_col = "gen")
head(described_sex)
}

}

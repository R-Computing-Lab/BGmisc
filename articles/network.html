<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Network tools for finding extended pedigrees and path tracing • BGmisc</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Network tools for finding extended pedigrees and path tracing">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">BGmisc</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/analyticrelatedness.html">Calculating and Inferring Relatedness Coefficients with BGmisc</a></li>
    <li><a class="dropdown-item" href="../articles/modelingrelatedness.html">Modeling variance components</a></li>
    <li><a class="dropdown-item" href="../articles/network.html">Network tools for finding extended pedigrees and path tracing</a></li>
    <li><a class="dropdown-item" href="../articles/partial.html">Adjacency matrix methods</a></li>
    <li><a class="dropdown-item" href="../articles/pedigree.html">Pedigree Simulation and Visualization with BGmisc</a></li>
    <li><a class="dropdown-item" href="../articles/validation.html">Validating and Repairing Pedigree Data with BGmisc</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/R-Computing-Lab/BGmisc/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Network tools for finding extended pedigrees and path tracing</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/R-Computing-Lab/BGmisc/blob/main/vignettes/network.Rmd" class="external-link"><code>vignettes/network.Rmd</code></a></small>
      <div class="d-none name"><code>network.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette showcases two key features that capitalize on the
network structure inherent in pedigrees:</p>
<ol style="list-style-type: decimal">
<li><p>Finding extended families with <em>any</em> connecting
relationships between members. This feature strictly uses a person’s ID,
mother’s ID, and father’s ID to find out which people in a dataset are
remotely related by any path, effectively finding all separable extended
families in a dataset.</p></li>
<li><p>Using path tracing rules to quantify the <em>amount</em> of
relatedness between all pairs of individuals in a dataset. The amount of
relatedness can be characterized by additive nuclear DNA, shared
mitochondrial DNA, sharing both parents, or being part of the same
extended pedigree.</p></li>
</ol>
<div class="section level3">
<h3 id="loading-required-libraries-and-data">Loading Required Libraries and Data<a class="anchor" aria-label="anchor" href="#loading-required-libraries-and-data"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/R-Computing-Lab/BGmisc/" class="external-link">BGmisc</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">potter</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="finding-extended-families">Finding Extended Families<a class="anchor" aria-label="anchor" href="#finding-extended-families"></a>
</h2>
<p>Many pedigree datasets only contain information on the person, their
mother, and their father, often without nuclear or extended family IDs.
Recognizing which sets of people are unrelated simplifies many
pedigree-related tasks. This function facilitates those tasks by finding
all the extended families. People within the same extended family have
at least some form of relation, however distant, while those in
different extended families have no relations.</p>
<div class="figure">
<img src="network_files/figure-html/unnamed-chunk-2-1.png" alt="Potter Family Pedigree" width="50%"><p class="caption">
Potter Family Pedigree
</p>
</div>
<p>We will use the <code>potter</code> pedigree data as an example. For
convenience, we’ve renamed the family ID variable to <code>oldfam</code>
to avoid confusion with the new family ID variable we will create.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_potter</span> <span class="op">&lt;-</span> <span class="va">potter</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df_potter</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df_potter</span><span class="op">)</span> <span class="op">==</span> <span class="st">"famID"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"oldfam"</span></span>
<span></span>
<span><span class="va">ds</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ped2fam.html">ped2fam</a></span><span class="op">(</span><span class="va">df_potter</span>, famID <span class="op">=</span> <span class="st">"famID"</span>, personID <span class="op">=</span> <span class="st">"personID"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">ds</span><span class="op">$</span><span class="va">famID</span>, <span class="va">ds</span><span class="op">$</span><span class="va">oldfam</span><span class="op">)</span></span>
<span><span class="co">#&gt;    </span></span>
<span><span class="co">#&gt;      1</span></span>
<span><span class="co">#&gt;   1 36</span></span></code></pre></div>
<p>Because the <code>potter</code> data already had a family ID
variable, we compare our newly created variable to the pre-existing one.
They match!</p>
</div>
<div class="section level2">
<h2 id="computing-relatedness">Computing Relatedness<a class="anchor" aria-label="anchor" href="#computing-relatedness"></a>
</h2>
<p>Once you know which sets of people are related at all to one another,
you’ll likely want to know how much. For additive genetic relatedness,
you can use the <code><a href="../reference/ped2add.html">ped2add()</a></code> function.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">add</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ped2add.html">ped2add</a></span><span class="op">(</span><span class="va">potter</span><span class="op">)</span></span></code></pre></div>
<p>This computes the additive genetic relatedness for everyone in the
data. It returns a square, symmetric matrix that has as many rows and
columns as there are IDs.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">add</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">7</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span></span>
<span><span class="co">#&gt;     1    2    3    4   5     6     7</span></span>
<span><span class="co">#&gt; 1 1.0 0.50 0.00 0.00 0.0 0.500 0.000</span></span>
<span><span class="co">#&gt; 2 0.5 1.00 0.00 0.00 0.0 0.250 0.000</span></span>
<span><span class="co">#&gt; 3 0.0 0.00 1.00 0.50 0.0 0.500 0.250</span></span>
<span><span class="co">#&gt; 4 0.0 0.00 0.50 1.00 0.0 0.250 0.500</span></span>
<span><span class="co">#&gt; 5 0.0 0.00 0.00 0.00 1.0 0.000 0.500</span></span>
<span><span class="co">#&gt; 6 0.5 0.25 0.50 0.25 0.0 1.000 0.125</span></span>
<span><span class="co">#&gt; 7 0.0 0.00 0.25 0.50 0.5 0.125 1.000</span></span></code></pre></div>
<p>The entry in the ith row and the jth column gives the relatedness
between person i and person j. For example, person 1 (Vernon Dursley)
shares 0.5 of their nuclear DNA with person 6 (Dudley Dursley), shares
0.5 of their nuclear DNA with person 2 (Marjorie Dursley).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">add</span><span class="op">)</span></span>
<span><span class="co">#&gt; add</span></span>
<span><span class="co">#&gt;      0 0.0625  0.125   0.25    0.5      1 </span></span>
<span><span class="co">#&gt;    788      6     94    208    164     36</span></span></code></pre></div>
<p>It’s probably fine to do this on the whole dataset when your data
have fewer than 10,000 people. When the data get large, however, it’s
much more efficient to compute this relatedness separately for each
extended family.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">add_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">potter</span><span class="op">$</span><span class="va">famID</span><span class="op">)</span>,</span>
<span>  <span class="kw">function</span><span class="op">(</span><span class="va">d</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">tmp</span> <span class="op">&lt;-</span> <span class="va">potter</span><span class="op">[</span><span class="va">potter</span><span class="op">$</span><span class="va">famID</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">d</span>, <span class="op">]</span></span>
<span>    <span class="fu"><a href="../reference/ped2add.html">ped2add</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="other-relatedness-measures">Other relatedness measures<a class="anchor" aria-label="anchor" href="#other-relatedness-measures"></a>
</h3>
<p>The function works similarly for mitochondrial
(<code>ped2mit</code>), common nuclear environment through sharing both
parents (<code>ped2cn</code>), and common extended family environment
(<code>ped2ce</code>).</p>
<div class="section level4">
<h4 id="computing-mitochondrial-relatedness">Computing mitochondrial relatedness<a class="anchor" aria-label="anchor" href="#computing-mitochondrial-relatedness"></a>
</h4>
<p>Here we calculate the mitochondrial relatedness between all pairs of
individuals in the <code>potter</code> dataset.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ped2mit.html">ped2mit</a></span><span class="op">(</span><span class="va">potter</span><span class="op">)</span></span>
<span><span class="va">mit</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">7</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span></span>
<span><span class="co">#&gt;   1 2 3 4 5 6 7</span></span>
<span><span class="co">#&gt; 1 1 1 0 0 0 0 0</span></span>
<span><span class="co">#&gt; 2 1 1 0 0 0 0 0</span></span>
<span><span class="co">#&gt; 3 0 0 1 1 0 1 1</span></span>
<span><span class="co">#&gt; 4 0 0 1 1 0 1 1</span></span>
<span><span class="co">#&gt; 5 0 0 0 0 1 0 0</span></span>
<span><span class="co">#&gt; 6 0 0 1 1 0 1 1</span></span>
<span><span class="co">#&gt; 7 0 0 1 1 0 1 1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">mit</span><span class="op">)</span></span>
<span><span class="co">#&gt; mit</span></span>
<span><span class="co">#&gt;    0    1 </span></span>
<span><span class="co">#&gt; 1082  214</span></span></code></pre></div>
<p>As you can see, some of the family members share mitochondrial DNA,
such as person 2 and person 3 0, whereas person 1 and person 3 do
not.</p>
</div>
<div class="section level4">
<h4 id="computing-relatedness-through-common-nuclear-environment">Computing relatedness through common nuclear environment<a class="anchor" aria-label="anchor" href="#computing-relatedness-through-common-nuclear-environment"></a>
</h4>
<p>Here we calculate the relatedness between all pairs of individuals in
the <code>potter</code> dataset through sharing both parents.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">commonNuclear</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ped2cn.html">ped2cn</a></span><span class="op">(</span><span class="va">potter</span><span class="op">)</span></span>
<span><span class="va">commonNuclear</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">7</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span></span>
<span><span class="co">#&gt;   1 2 3 4 5 6 7</span></span>
<span><span class="co">#&gt; 1 1 1 0 0 0 0 0</span></span>
<span><span class="co">#&gt; 2 1 1 0 0 0 0 0</span></span>
<span><span class="co">#&gt; 3 0 0 1 1 0 0 0</span></span>
<span><span class="co">#&gt; 4 0 0 1 1 0 0 0</span></span>
<span><span class="co">#&gt; 5 0 0 0 0 1 0 0</span></span>
<span><span class="co">#&gt; 6 0 0 0 0 0 1 0</span></span>
<span><span class="co">#&gt; 7 0 0 0 0 0 0 1</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">commonNuclear</span><span class="op">)</span></span>
<span><span class="co">#&gt; commonNuclear</span></span>
<span><span class="co">#&gt;    0    1 </span></span>
<span><span class="co">#&gt; 1196  100</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="computing-relatedness-through-common-extended-family-environment">Computing relatedness through common extended family
environment<a class="anchor" aria-label="anchor" href="#computing-relatedness-through-common-extended-family-environment"></a>
</h4>
<p>Here we calculate the relatedness between all pairs of individuals in
the <code>potter</code> dataset through sharing an extended family.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">extendedFamilyEnvironment</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ped2ce.html">ped2ce</a></span><span class="op">(</span><span class="va">potter</span><span class="op">)</span></span>
<span><span class="va">extendedFamilyEnvironment</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">7</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5] [,6] [,7]</span></span>
<span><span class="co">#&gt; [1,]    1    1    1    1    1    1    1</span></span>
<span><span class="co">#&gt; [2,]    1    1    1    1    1    1    1</span></span>
<span><span class="co">#&gt; [3,]    1    1    1    1    1    1    1</span></span>
<span><span class="co">#&gt; [4,]    1    1    1    1    1    1    1</span></span>
<span><span class="co">#&gt; [5,]    1    1    1    1    1    1    1</span></span>
<span><span class="co">#&gt; [6,]    1    1    1    1    1    1    1</span></span>
<span><span class="co">#&gt; [7,]    1    1    1    1    1    1    1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">extendedFamilyEnvironment</span><span class="op">)</span></span>
<span><span class="co">#&gt; extendedFamilyEnvironment</span></span>
<span><span class="co">#&gt;    1 </span></span>
<span><span class="co">#&gt; 1296</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="subsetting-pedigrees">Subsetting Pedigrees<a class="anchor" aria-label="anchor" href="#subsetting-pedigrees"></a>
</h2>
<p>Subsetting a pedigree allows researchers to focus on specific family
lines or individuals within a larger dataset. This can be particularly
useful for data validation as well as simplifying complex pedigrees for
visualization. However, subsetting a pedigree can result in the
underestimation of relatedness between individuals. This is because the
subsetted pedigree may not contain all the individuals that connect two
people together. For example if we were to remove Arthur Weasley (person
9) and Molly Prewett (person 10) from the <code>potter</code> dataset,
we would lose the connections amongst their children.</p>
<div class="figure">
<img src="network_files/figure-html/unnamed-chunk-11-1.png" alt="Potter Subset Pedigree" width="50%"><p class="caption">
Potter Subset Pedigree
</p>
</div>
<p>In the plot above, we have removed Arthur Weasley (person 9) and
Molly Prewett (person 10) from the <code>potter</code> dataset. As a
result, the connections between their children are lost.</p>
<p>Similarly, if we remove the children of Vernon Dursley (1) and
Petunia Evans (3) from the <code>potter</code> dataset, we would lose
the connections between the two individuals.</p>
<p>However, this subset does not plot the relationship between spouses
(such as the marriage between Vernon Dursley and Petunia Evans), as
there are not children to connect the two individuals together yet.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">subset_rows</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">31</span><span class="op">:</span><span class="fl">36</span><span class="op">)</span></span>
<span><span class="va">subset_potter</span> <span class="op">&lt;-</span> <span class="va">potter</span><span class="op">[</span><span class="va">subset_rows</span>, <span class="op">]</span></span></code></pre></div>
<p><img src="network_files/figure-html/unnamed-chunk-13-1.png" width="50%"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by S. Mason Garrison, Michael D. Hunter, Xuanyu Lyu, Jonathan D. Trattner, S. Alexandra Burt.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>

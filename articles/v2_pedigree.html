<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Pedigree Simulation and Visualization with BGmisc • BGmisc</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Pedigree Simulation and Visualization with BGmisc">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">BGmisc</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4.3.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/v0_network.html">Network tools for finding extended pedigrees and path tracing</a></li>
    <li><a class="dropdown-item" href="../articles/v1_modelingvariancecomponents.html">Modeling variance components</a></li>
    <li><a class="dropdown-item" href="../articles/v2_pedigree.html">Pedigree Simulation and Visualization with BGmisc</a></li>
    <li><a class="dropdown-item" href="../articles/v3_analyticrelatedness.html">Understanding and Computing Relatedness from Pedigree Data</a></li>
    <li><a class="dropdown-item" href="../articles/v4_validation.html">Validating and Repairing Pedigree Data with BGmisc</a></li>
    <li><a class="dropdown-item" href="../articles/v5_ASOIAF.html">ASOIAF: How related are Jon and Danny?</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/R-Computing-Lab/BGmisc/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Pedigree Simulation and Visualization with BGmisc</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/R-Computing-Lab/BGmisc/blob/v1.4.3.1/vignettes/v2_pedigree.Rmd" class="external-link"><code>vignettes/v2_pedigree.Rmd</code></a></small>
      <div class="d-none name"><code>v2_pedigree.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Unlike Tolstoy, where <em>only</em> happy families are alike, all
pedigrees are alike – or at least, all simulated pedigrees are alike.
The <code>simulatePedigree</code> function generates a pedigree with a
user-specified number of generations and individuals per generation.
This function provides users the opportunity to test family models in
pedigrees with a customized pedigree length and width.</p>
<p>These pedigrees can be simulated as a function of several parameters,
including the number of children per mate, generations, sex ratio of
newborns, and mating rate. Given that large family pedigrees are
difficult to collect or access, simulated pedigrees serve as an
efficient tool for researchers. These simulated pedigrees are useful for
building family-based statistical models, and evaluating their
statistical properties, such as power, bias, and computational
efficiency.</p>
<p>To illustrate this functionality, let us generate a pedigree. This
pedigree has a total of four generations (<code>Ngen</code>), in which
each person who “mates”, grows a family with four offspring
(<code>kpc</code>). In our scenario, the number of male and female
newborns is equal, but can be adjusted via (<code>sexR</code>). In this
illustration 70% of individuals will mate and bear offspring
(<code>marR</code>). Such a pedigree structure can be simulated by
running the following code:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Loading Required Libraries</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/R-Computing-Lab/BGmisc/" class="external-link">BGmisc</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/R-Computing-Lab/ggpedigree/" class="external-link">ggpedigree</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">df_ped</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulatePedigree.html">simulatePedigree</a></span><span class="op">(</span></span>
<span>  kpc <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  Ngen <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  sexR <span class="op">=</span> <span class="fl">.5</span>,</span>
<span>  marR <span class="op">=</span> <span class="fl">.7</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">df_ped</span><span class="op">)</span></span>
<span><span class="co">#&gt;      fam                  ID              gen            dadID       </span></span>
<span><span class="co">#&gt;  Length:57          Min.   : 10011   Min.   :1.000   Min.   : 10012  </span></span>
<span><span class="co">#&gt;  Class :character   1st Qu.: 10036   1st Qu.:3.000   1st Qu.: 10024  </span></span>
<span><span class="co">#&gt;  Mode  :character   Median :100312   Median :3.000   Median : 10037  </span></span>
<span><span class="co">#&gt;                     Mean   : 59171   Mean   :3.298   Mean   : 42859  </span></span>
<span><span class="co">#&gt;                     3rd Qu.:100416   3rd Qu.:4.000   3rd Qu.:100311  </span></span>
<span><span class="co">#&gt;                     Max.   :100432   Max.   :4.000   Max.   :100320  </span></span>
<span><span class="co">#&gt;                                                      NA's   :13      </span></span>
<span><span class="co">#&gt;      momID             spID            sex           </span></span>
<span><span class="co">#&gt;  Min.   : 10011   Min.   : 10011   Length:57         </span></span>
<span><span class="co">#&gt;  1st Qu.: 10022   1st Qu.: 10025   Class :character  </span></span>
<span><span class="co">#&gt;  Median : 10036   Median : 10036   Mode  :character  </span></span>
<span><span class="co">#&gt;  Mean   : 42859   Mean   : 40124                     </span></span>
<span><span class="co">#&gt;  3rd Qu.:100316   3rd Qu.:100311                     </span></span>
<span><span class="co">#&gt;  Max.   :100318   Max.   :100320                     </span></span>
<span><span class="co">#&gt;  NA's   :13       NA's   :33</span></span></code></pre></div>
<p>The simulation output is a <code>data.frame</code> with 57 rows and 7
columns. Each row corresponds to a simulated individual.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_ped</span><span class="op">[</span><span class="fl">21</span>, <span class="op">]</span></span>
<span><span class="co">#&gt;      fam     ID gen dadID momID   spID sex</span></span>
<span><span class="co">#&gt; 21 fam 1 100312   3 10024 10022 100317   M</span></span></code></pre></div>
<p>The columns represents the individual’s family ID, the individual’s
personal ID, the generation the individual is in, the IDs of their
father and mother, the ID of their spouse, and the biological sex of the
individual, respectively.</p>
<div class="section level3">
<h3 id="summarizing-pedigrees">Summarizing Pedigrees<a class="anchor" aria-label="anchor" href="#summarizing-pedigrees"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/summarizeFamilies.html">summarizeFamilies</a></span><span class="op">(</span><span class="va">df_ped</span>, famID <span class="op">=</span> <span class="st">"fam"</span><span class="op">)</span><span class="op">$</span><span class="va">family_summary</span></span>
<span><span class="co">#&gt;       fam count gen_mean gen_median gen_min gen_max    gen_sd spID_mean</span></span>
<span><span class="co">#&gt;    &lt;char&gt; &lt;int&gt;    &lt;num&gt;      &lt;num&gt;   &lt;num&gt;   &lt;num&gt;     &lt;num&gt;     &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:  fam 1    57 3.298246          3       1       4 0.8229935   40123.5</span></span>
<span><span class="co">#&gt;    spID_median spID_min spID_max  spID_sd</span></span>
<span><span class="co">#&gt;          &lt;num&gt;    &lt;num&gt;    &lt;num&gt;    &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:     10035.5    10011   100320 43476.96</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="plotting-pedigree">Plotting Pedigree<a class="anchor" aria-label="anchor" href="#plotting-pedigree"></a>
</h3>
<p>Pedigrees are visual diagrams that represent family relationships
across generations. They are commonly used in genetics to trace the
inheritance of specific traits or conditions. This vignette will guide
you through visualizing simulated pedigrees using the
<code>plotPedigree</code> function. This function is a wrapper function
for <code>Kinship2</code>’s base R plotting. The sister package
ggpedigree has a much nicer plotting function. It’s also available on
CRAN, but it is not a dependency of BGmisc. If you want to use
ggpedigree, you can install it with
<code>install.packages("ggpedigree")</code> and then use
<code>ggplot2</code> syntax to plot pedigrees.</p>
<div class="section level4">
<h4 id="single-pedigree-visualization">Single Pedigree Visualization<a class="anchor" aria-label="anchor" href="#single-pedigree-visualization"></a>
</h4>
<p>To visualize a single simulated pedigree, use the the
<code>plotPedigree</code> function allows you to visualize the pedigree
structure, including family relationships and individual
characteristics. The plot displays individuals across generations, with
lines connecting parents to their children, and spouses connected by
horizontal lines.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/R-Computing-Lab/ggpedigree/" class="external-link">ggpedigree</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_ped_recoded</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/recodeSex.html">recodeSex</a></span><span class="op">(</span><span class="va">df_ped</span>, code_male <span class="op">=</span> <span class="st">"M"</span>, recode_male <span class="op">=</span> <span class="fl">1</span>, recode_female <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggpedigree</span><span class="fu">::</span><span class="fu"><a href="https://r-computing-lab.github.io/ggpedigree/reference/ggPedigree.html" class="external-link">ggpedigree</a></span><span class="op">(</span><span class="va">df_ped_recoded</span>,</span>
<span>  personID <span class="op">=</span> <span class="st">"ID"</span>,</span>
<span>  code_male <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="v2_pedigree_files/figure-html/unnamed-chunk-5-1.png" width="768"></p>
<p>In the resulting plot, biological males are represented by squares,
while biological females are represented by circles, following the
standard pedigree conventions.</p>
</div>
<div class="section level4">
<h4 id="visualizing-multiple-pedigrees-side-by-side">Visualizing Multiple Pedigrees Side-by-Side<a class="anchor" aria-label="anchor" href="#visualizing-multiple-pedigrees-side-by-side"></a>
</h4>
<p>If you wish to compare different pedigrees side by side, you can plot
them together. For instance, let’s visualize pedigrees for families
spanning three and four generations, respectively.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">8</span><span class="op">)</span></span>
<span><span class="co"># Simulate a family with 3 generations</span></span>
<span><span class="va">df_ped_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulatePedigree.html">simulatePedigree</a></span><span class="op">(</span>Ngen <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulate a family with 4 generations</span></span>
<span><span class="va">df_ped_4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulatePedigree.html">simulatePedigree</a></span><span class="op">(</span>Ngen <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<p>You can use the <code>ggpedigree</code> package to plot multiple
pedigrees side by side. This package allows for more customization and
better aesthetics in pedigree visualization.</p>
<p><img src="v2_pedigree_files/figure-html/unnamed-chunk-7-1.png" width="768"></p>
<p>By examining the side-by-side plots, you can contrast and analyze the
structures of different families, tracing the inheritance of specific
traits or conditions if needed.</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by S. Mason Garrison, Michael D. Hunter, Xuanyu Lyu, Jonathan D. Trattner, S. Alexandra Burt.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>

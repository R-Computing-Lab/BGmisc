<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Understanding and Computing Relatedness from Pedigree Data ‚Ä¢ BGmisc</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Understanding and Computing Relatedness from Pedigree Data">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">BGmisc</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.5.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/v0_network.html">Network tools for finding extended pedigrees and path tracing</a></li>
    <li><a class="dropdown-item" href="../articles/v1_modelingvariancecomponents.html">Modeling variance components</a></li>
    <li><a class="dropdown-item" href="../articles/v2_pedigree.html">Pedigree Simulation and Visualization with BGmisc</a></li>
    <li><a class="dropdown-item" href="../articles/v3_analyticrelatedness.html">Understanding and Computing Relatedness from Pedigree Data</a></li>
    <li><a class="dropdown-item" href="../articles/v4_validation.html">Validating and Repairing Pedigree Data with BGmisc</a></li>
    <li><a class="dropdown-item" href="../articles/v5_ASOIAF.html">ASOIAF: How related are Jon and Danny?</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/R-Computing-Lab/BGmisc/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Understanding and Computing Relatedness from Pedigree Data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/R-Computing-Lab/BGmisc/blob/v1.5.2/vignettes/v3_analyticrelatedness.Rmd" class="external-link"><code>vignettes/v3_analyticrelatedness.Rmd</code></a></small>
      <div class="d-none name"><code>v3_analyticrelatedness.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>When individuals share common ancestors, they are genetically
related: they are expected to carry some proportion of alleles that are
identical by descent. This expectation‚Äîcalled the relatedness
coefficient‚Äîis central to many areas of genetics, including heritability
estimation, pedigree-based modeling, twin and family studies, and the
construction of kinship matrices for mixed-effects models.</p>
<p>Understanding relatedness is key for interpreting familial
resemblance, controlling for shared genetic structure in statistical
models, and simulating or analyzing traits across multigenerational
pedigrees. But while the idea that ‚Äúsiblings are 50% related‚Äù is
familiar, the reasoning behind such numbers‚Äîand how to compute them
across complex family structures‚Äîis less transparent.</p>
<p>This vignette introduces the concept of relatedness from first
principles and walks through how it is calculated from pedigree data. It
begins with illustrative examples that explain expected relatedness
values for familiar relationships using simplified functions. These
examples clarify how shared ancestry translates into probabilistic
expectations about genetic similarity.</p>
<p>From there, the vignette introduces a general-purpose matrix-based
method for computing pairwise relatedness across pedigrees. Using the
<code><a href="../reference/ped2com.html">ped2com()</a></code> function, we demonstrate how to build additive
genetic relationship matrices under both complete and incomplete
parentage, and we evaluate how different assumptions affect the
resulting estimates. The goal is to provide a clear, rigorous, and
practical guide to computing relatedness in real data.</p>
</div>
<div class="section level2">
<h2 id="relatedness-coefficient">Relatedness Coefficient<a class="anchor" aria-label="anchor" href="#relatedness-coefficient"></a>
</h2>
<p>The relatedness coefficient
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>r</mi><annotation encoding="application/x-tex">r</annotation></semantics></math>
indexes the proportion of alleles shared identically by descent (IBD)
between two individuals. This value ranges from 0 (no shared alleles by
descent) to 1 (a perfect genetic match, which occurs when comparing an
individual to themselves, their identical twin, or their clone). Values
can be interpreted in the context of standard relationships: e.g., full
siblings are expected to have
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>=</mo><mn>0.5</mn></mrow><annotation encoding="application/x-tex">r = 0.5</annotation></semantics></math>,
half siblings
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>=</mo><mn>0.25</mn></mrow><annotation encoding="application/x-tex">r = 0.25</annotation></semantics></math>,
and first cousins
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>=</mo><mn>0.125</mn></mrow><annotation encoding="application/x-tex">r = 0.125</annotation></semantics></math>.</p>
<p>Wright‚Äôs (1922) classic formulation computes ùëü by summing across
shared ancestry paths:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mrow><mi>b</mi><mi>c</mi></mrow></msub><mo>=</mo><mo>‚àë</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>n</mi><mo>+</mo><mi>n</mi><mi>‚Ä≤</mi><mo>+</mo><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><msub><mi>f</mi><mi>a</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
r_{bc} = \sum \left(\frac{1}{2}\right)^{n+n'+1} (1+f_a)
</annotation></semantics></math></p>
<p>Here,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mi>‚Ä≤</mi></mrow><annotation encoding="application/x-tex">n'</annotation></semantics></math>
are the number of generations from each descendant to a common ancestor
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>a</mi><annotation encoding="application/x-tex">a</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>f</mi><mi>a</mi></msub><annotation encoding="application/x-tex">f_a</annotation></semantics></math>
is the inbreeding coefficient of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>a</mi><annotation encoding="application/x-tex">a</annotation></semantics></math>,
assumed to be zero unless specified otherwise.</p>
<p>The function <code>calculateRelatedness</code> computes the
relatedness coefficient based on the number of generations back to
common ancestors, whether the individuals are full siblings, and other
parameters. The function can be used to calculate relatedness for
various family structures, including full siblings, half siblings, and
cousins.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/R-Computing-Lab/BGmisc/" class="external-link">BGmisc</a></span><span class="op">)</span></span>
<span><span class="co"># Example usage:</span></span>
<span><span class="co"># For full siblings, the relatedness coefficient is expected to be 0.5:</span></span>
<span><span class="fu"><a href="../reference/calculateRelatedness.html">calculateRelatedness</a></span><span class="op">(</span>generations <span class="op">=</span> <span class="fl">1</span>, full <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.5</span></span>
<span><span class="co"># For half siblings, the relatedness coefficient is expected to be 0.25:</span></span>
<span><span class="fu"><a href="../reference/calculateRelatedness.html">calculateRelatedness</a></span><span class="op">(</span>generations <span class="op">=</span> <span class="fl">1</span>, full <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.25</span></span></code></pre></div>
<p>The logic reflects the number and type of shared parents. For full
siblings, both parents are shared (generational paths = 1 + 1), while
for half siblings only one is (effectively halving the probability of
sharing an allele). In otherwords, when <code>full = TRUE</code>, each
sibling is one generation from the shared pair of parents, yielding
<code>r=0.5</code>. When <code>full = FALSE</code>, they share only one
parent, yielding <code>r=0.25</code>.</p>
</div>
<div class="section level2">
<h2 id="inferring-r-from-observed-phenotypic-correlation">Inferring r from Observed Phenotypic Correlation<a class="anchor" aria-label="anchor" href="#inferring-r-from-observed-phenotypic-correlation"></a>
</h2>
<p>In some cases, you observe a phenotypic correlation (e.g., height,
cognition) between two individuals and want to infer what value of r
would be consistent with that correlation under a fixed ACE model</p>
<p>The <code>inferRelatedness</code> function inverts the equation:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">obsR</mtext><mo>=</mo><mi>r</mi><mo>‚ãÖ</mo><msup><mi>a</mi><mn>2</mn></msup><mo>+</mo><mtext mathvariant="normal">sharedC</mtext><mo>‚ãÖ</mo><msup><mi>c</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">
\text{obsR} = r \cdot a^2 + \text{sharedC} \cdot c^2
 </annotation></semantics></math></p>
<p>to solve for:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>=</mo><mfrac><mrow><mtext mathvariant="normal">obsR</mtext><mo>‚àí</mo><mtext mathvariant="normal">sharedC</mtext><mo>‚ãÖ</mo><msup><mi>c</mi><mn>2</mn></msup></mrow><msup><mi>a</mi><mn>2</mn></msup></mfrac></mrow><annotation encoding="application/x-tex">
 r = \frac{\text{obsR} - \text{sharedC} \cdot c^2}{a^2}
 </annotation></semantics></math></p>
<p>where: - <code>obsR</code> is the observed phenotypic correlation
between two individuals or groups. - <code>aceA</code> and
<code>aceC</code> represent the proportions of variance due to additive
genetic and shared environmental influences, respectively. -
<code>sharedC</code> is the shared-environment analog to the relatedness
coefficient: it indicates what proportion of the shared environmental
variance applies to this pair (e.g., 1 for siblings raised together, 0
for siblings raised apart).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example usage:</span></span>
<span><span class="co"># Infer the relatedness coefficient:</span></span>
<span><span class="fu"><a href="../reference/inferRelatedness.html">inferRelatedness</a></span><span class="op">(</span>obsR <span class="op">=</span> <span class="fl">0.5</span>, aceA <span class="op">=</span> <span class="fl">0.9</span>, aceC <span class="op">=</span> <span class="fl">0</span>, sharedC <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.5555556</span></span></code></pre></div>
<p>In this example, the observed correlation is 0.5, and no shared
environmental variance is assumed. Given that additive genetic variance
accounts for 90% of trait variance, the inferred relatedness coefficient
is approximately 0.556. This reflects the proportion of genetic overlap
that would be required to produce the observed similarity under these
assumptions.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Now assume shared environment is fully shared:</span></span>
<span><span class="fu"><a href="../reference/inferRelatedness.html">inferRelatedness</a></span><span class="op">(</span>obsR <span class="op">=</span> <span class="fl">0.5</span>, aceA <span class="op">=</span> <span class="fl">0.45</span>, aceC <span class="op">=</span> <span class="fl">0.45</span>, sharedC <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.1111111</span></span></code></pre></div>
<p>In this case, the observed phenotypic correlation is still 0.5, and
both additive genetic and shared environmental components are assumed to
explain 45% of the variance. Because the shared environment is fully
shared between individuals (sharedC = 1), much of the observed
similarity is attributed to C, leaving only a small portion attributable
to genetic relatedness. The function returns an inferred relatedness
coefficient of approximately 0.11 ‚Äî that is, the amount of additive
genetic overlap required (under this model) to produce the remaining
unexplained correlation after accounting for shared environmental
similarity.</p>
</div>
<div class="section level2">
<h2 id="computing-relatedness-from-pedigree-data">Computing Relatedness from Pedigree Data<a class="anchor" aria-label="anchor" href="#computing-relatedness-from-pedigree-data"></a>
</h2>
<p>The <code>ped2com</code> function computes relationship matrices from
pedigree data using a recursive algorithm based on parent-offspring
connections. Central to this computation is the parent
<code>adjacency matrix</code>, which defines how individuals in the
pedigree are connected across generations. The adjacency matrix acts as
the structural input from which genetic relatedness is propagated.</p>
<p>The function offers two methods for constructing this matrix:</p>
<ol style="list-style-type: decimal">
<li>The classic method, which assumes that all parents are known and
that the adjacency matrix is complete.</li>
<li>The partial parent method, which allows for missing values in the
parent adjacency matrix.</li>
</ol>
<p>When parent data are complete, both methods return equivalent
results. But when parental information is missing, their behavior
diverges. This vignette illustrates how and why these differences
emerge, and under what conditions the partial method provides more
accurate results.</p>
<div class="section level3">
<h3 id="hazard-data-example">Hazard Data Example<a class="anchor" aria-label="anchor" href="#hazard-data-example"></a>
</h3>
<p>We begin with the <code>hazard</code> dataset. First, we examine
behavior under complete pedigree data.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/R-Computing-Lab/BGmisc/" class="external-link">BGmisc</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/R-Computing-Lab/ggpedigree/" class="external-link">ggpedigree</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">hazard</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">hazard</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>personID <span class="op">=</span> <span class="va">ID</span><span class="op">)</span> <span class="co"># this is the data that we will use for the example</span></span>
<span></span>
<span><span class="co"># Plot the pedigree to visualize relationships</span></span>
<span></span>
<span><span class="fu"><a href="https://r-computing-lab.github.io/ggpedigree/reference/ggPedigree.html" class="external-link">ggpedigree</a></span><span class="op">(</span><span class="va">df</span>, config <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  personID <span class="op">=</span> <span class="st">"personID"</span>,</span>
<span>  momID <span class="op">=</span> <span class="st">"momID"</span>,</span>
<span>  dadID <span class="op">=</span> <span class="st">"dadID"</span>,</span>
<span>  famID <span class="op">=</span> <span class="st">"famID"</span>,</span>
<span>  code_male <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in buildPlotConfig(default_config = default_config, config = config, :</span></span>
<span><span class="co">#&gt; The following config values are not recognized by getDefaultPlotConfig():</span></span>
<span><span class="co">#&gt; momID, dadID, famID</span></span></code></pre></div>
<p><img src="v3_analyticrelatedness_files/figure-html/unnamed-chunk-5-1.png" class="r-plt" alt="" width="700"></p>
<p>We compute the additive genetic relationship matrix using both the
classic and partial parent methods. Because the pedigree is complete, we
expect no differences in the resulting matrices.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ped_add_partial_complete</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ped2com.html">ped2com</a></span><span class="op">(</span><span class="va">df</span>,</span>
<span>  isChild_method <span class="op">=</span> <span class="st">"partialparent"</span>,</span>
<span>  component <span class="op">=</span> <span class="st">"additive"</span>,</span>
<span>  adjacency_method <span class="op">=</span> <span class="st">"direct"</span>,</span>
<span>  sparse <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">ped_add_classic_complete</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ped2com.html">ped2com</a></span><span class="op">(</span><span class="va">df</span>,</span>
<span>  isChild_method <span class="op">=</span> <span class="st">"classic"</span>,</span>
<span>  component <span class="op">=</span> <span class="st">"additive"</span>, adjacency_method <span class="op">=</span> <span class="st">"direct"</span>,</span>
<span>  sparse <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The following plots display the full additive matrices. These
matrices should be identical.</p>
<p>This can be confirmed visually and numerically.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/R-Computing-Lab/ggpedigree/" class="external-link">ggpedigree</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://r-computing-lab.github.io/ggpedigree/reference/ggRelatednessMatrix.html" class="external-link">ggRelatednessMatrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">ped_add_classic_complete</span><span class="op">)</span>,</span>
<span>  config <span class="op">=</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Additive component - Classic method"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in buildPlotConfig(default_config = default_config, config = config, :</span></span>
<span><span class="co">#&gt; The following config values are not recognized by getDefaultPlotConfig(): title</span></span></code></pre></div>
<p><img src="v3_analyticrelatedness_files/figure-html/unnamed-chunk-7-1.png" class="r-plt" alt="" width="700"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://r-computing-lab.github.io/ggpedigree/reference/ggRelatednessMatrix.html" class="external-link">ggRelatednessMatrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">ped_add_partial_complete</span><span class="op">)</span>,</span>
<span>  config <span class="op">=</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Additive component - Partial parent method"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in buildPlotConfig(default_config = default_config, config = config, :</span></span>
<span><span class="co">#&gt; The following config values are not recognized by getDefaultPlotConfig(): title</span></span></code></pre></div>
<p><img src="v3_analyticrelatedness_files/figure-html/unnamed-chunk-7-2.png" class="r-plt" alt="" width="700"></p>
<p>To verify this, we subtract one matrix from the other and calculate
RMSE. The difference should be numerically zero. Indeed, it is 0.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/taiyun/corrplot" class="external-link">corrplot</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; corrplot 0.95 loaded</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html" class="external-link">corrplot</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">ped_add_classic_complete</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">ped_add_partial_complete</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"color"</span>, type <span class="op">=</span> <span class="st">"lower"</span>, col.lim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  is.corr <span class="op">=</span> <span class="cn">FALSE</span>, order <span class="op">=</span> <span class="st">"hclust"</span>,</span>
<span>  tl.pos <span class="op">=</span> <span class="st">"l"</span>, tl.col <span class="op">=</span> <span class="st">"black"</span>, tl.srt <span class="op">=</span> <span class="fl">5</span>, tl.cex <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/COL1.html" class="external-link">COL1</a></span><span class="op">(</span><span class="st">"Reds"</span>, <span class="fl">100</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="v3_analyticrelatedness_files/figure-html/unnamed-chunk-8-1.png" class="r-plt" alt="" width="700"></p>
</div>
<div class="section level3">
<h3 id="introducing-missingness-remove-a-parent">Introducing Missingness: Remove a Parent<a class="anchor" aria-label="anchor" href="#introducing-missingness-remove-a-parent"></a>
</h3>
<p>To observe how the two methods diverge when data are incomplete, we
remove one parent‚Äîstarting with the mother of individual 4.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span><span class="op">$</span><span class="va">momID</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">ID</span> <span class="op">==</span> <span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ped_add_partial_mom</span> <span class="op">&lt;-</span> <span class="va">ped_add_partial</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ped2com.html">ped2com</a></span><span class="op">(</span><span class="va">df</span>,</span>
<span>  isChild_method <span class="op">=</span> <span class="st">"partialparent"</span>,</span>
<span>  component <span class="op">=</span> <span class="st">"additive"</span>,</span>
<span>  adjacency_method <span class="op">=</span> <span class="st">"direct"</span>,</span>
<span>  sparse <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">ped_add_classic_mom</span> <span class="op">&lt;-</span> <span class="va">ped_add_classic</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ped2com.html">ped2com</a></span><span class="op">(</span><span class="va">df</span>,</span>
<span>  isChild_method <span class="op">=</span> <span class="st">"classic"</span>,</span>
<span>  component <span class="op">=</span> <span class="st">"additive"</span>, adjacency_method <span class="op">=</span> <span class="st">"direct"</span>,</span>
<span>  sparse <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The two methods now treat individual 4 differently in the parent
adjacency matrix. The classic method applies a fixed contribution
because one parent remains. The partial parent method inflates the
individual‚Äôs diagonal contribution to account for the missing
parent.</p>
<p>The resulting additive matrices reflect this difference. The RMSE
between the two matrices is 0.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html" class="external-link">corrplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">ped_add_classic</span><span class="op">)</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"color"</span>, type <span class="op">=</span> <span class="st">"lower"</span>, col.lim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  is.corr <span class="op">=</span> <span class="cn">FALSE</span>, title <span class="op">=</span> <span class="st">"Classic (mother removed)"</span>,</span>
<span>  order <span class="op">=</span> <span class="st">"hclust"</span>,</span>
<span>  tl.pos <span class="op">=</span> <span class="st">"l"</span>, tl.col <span class="op">=</span> <span class="st">"black"</span>, tl.srt <span class="op">=</span> <span class="fl">5</span>, tl.cex <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/COL1.html" class="external-link">COL1</a></span><span class="op">(</span><span class="st">"Reds"</span>, <span class="fl">100</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="v3_analyticrelatedness_files/figure-html/unnamed-chunk-11-1.png" class="r-plt" alt="" width="700"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html" class="external-link">corrplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">ped_add_partial</span><span class="op">)</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"color"</span>, type <span class="op">=</span> <span class="st">"lower"</span>, col.lim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  is.corr <span class="op">=</span> <span class="cn">FALSE</span>, title <span class="op">=</span> <span class="st">"Partial (mother removed)"</span>,</span>
<span>  order <span class="op">=</span> <span class="st">"hclust"</span>,</span>
<span>  tl.pos <span class="op">=</span> <span class="st">"l"</span>, tl.col <span class="op">=</span> <span class="st">"black"</span>, tl.srt <span class="op">=</span> <span class="fl">5</span>, tl.cex <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/COL1.html" class="external-link">COL1</a></span><span class="op">(</span><span class="st">"Reds"</span>, <span class="fl">100</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="v3_analyticrelatedness_files/figure-html/unnamed-chunk-11-2.png" class="r-plt" alt="" width="700"></p>
<p>We quantify the overall matrix difference:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">ped_add_classic</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">ped_add_partial</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0</span></span></code></pre></div>
<p>Next, we compare each method to the matrix from the complete
pedigree. This evaluates how much each method deviates from the correct
additive structure.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html" class="external-link">corrplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">ped_add_classic_complete</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">ped_add_classic</span><span class="op">)</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"color"</span>, type <span class="op">=</span> <span class="st">"lower"</span>, col.lim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  is.corr <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  order <span class="op">=</span> <span class="st">"hclust"</span>,</span>
<span>  tl.pos <span class="op">=</span> <span class="st">"l"</span>, tl.col <span class="op">=</span> <span class="st">"black"</span>, tl.srt <span class="op">=</span> <span class="fl">5</span>, tl.cex <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/COL1.html" class="external-link">COL1</a></span><span class="op">(</span><span class="st">"Reds"</span>, <span class="fl">100</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in corrplot(as.matrix(ped_add_classic_complete) -</span></span>
<span><span class="co">#&gt; as.matrix(ped_add_classic), : col.lim interval too wide, please set a suitable</span></span>
<span><span class="co">#&gt; value</span></span></code></pre></div>
<p><img src="v3_analyticrelatedness_files/figure-html/unnamed-chunk-13-1.png" class="r-plt" alt="" width="700"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">ped_add_classic_complete</span> <span class="op">-</span> <span class="va">ped_add_classic</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0</span></span></code></pre></div>
<p>The RMSE between the true additive component and the classic method
is 0.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html" class="external-link">corrplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">ped_add_classic_complete</span> <span class="op">-</span> <span class="va">ped_add_partial</span><span class="op">)</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"color"</span>, type <span class="op">=</span> <span class="st">"lower"</span>, col.lim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  is.corr <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  order <span class="op">=</span> <span class="st">"hclust"</span>,</span>
<span>  tl.pos <span class="op">=</span> <span class="st">"l"</span>, tl.col <span class="op">=</span> <span class="st">"black"</span>, tl.srt <span class="op">=</span> <span class="fl">5</span>, tl.cex <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/COL1.html" class="external-link">COL1</a></span><span class="op">(</span><span class="st">"Reds"</span>, <span class="fl">100</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in corrplot(as.matrix(ped_add_classic_complete - ped_add_partial), :</span></span>
<span><span class="co">#&gt; col.lim interval too wide, please set a suitable value</span></span></code></pre></div>
<p><img src="v3_analyticrelatedness_files/figure-html/unnamed-chunk-14-1.png" class="r-plt" alt="" width="700"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">ped_add_classic_complete</span> <span class="op">-</span> <span class="va">ped_add_partial</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0</span></span></code></pre></div>
<p>The RMSE between the true additive component and the partial parent
method is 0.</p>
<p>The partial method shows smaller deviations from the complete matrix,
confirming that it better preserves relatedness structure when one
parent is missing.</p>
<div class="section level4">
<h4 id="removing-the-father-instead">Removing the Father Instead<a class="anchor" aria-label="anchor" href="#removing-the-father-instead"></a>
</h4>
<p>We now repeat the same process, this time removing the father of
individual 4.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">hazard</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">hazard</span> <span class="co"># this is the data that we will use for the example</span></span>
<span></span>
<span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">dadID</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">ID</span> <span class="op">==</span> <span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="co"># add</span></span>
<span><span class="va">ped_add_partial_dad</span> <span class="op">&lt;-</span> <span class="va">ped_add_partial</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ped2com.html">ped2com</a></span><span class="op">(</span><span class="va">df</span>,</span>
<span>  isChild_method <span class="op">=</span> <span class="st">"partialparent"</span>,</span>
<span>  component <span class="op">=</span> <span class="st">"additive"</span>,</span>
<span>  adjacency_method <span class="op">=</span> <span class="st">"direct"</span>,</span>
<span>  sparse <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">ped_add_classic_dad</span> <span class="op">&lt;-</span> <span class="va">ped_add_classic</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ped2com.html">ped2com</a></span><span class="op">(</span><span class="va">df</span>,</span>
<span>  isChild_method <span class="op">=</span> <span class="st">"classic"</span>,</span>
<span>  component <span class="op">=</span> <span class="st">"additive"</span>, adjacency_method <span class="op">=</span> <span class="st">"direct"</span>,</span>
<span>  sparse <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>As we can see, the two matrices are different. The RMSE between the
two matrices is 0.009811.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html" class="external-link">corrplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">ped_add_classic_dad</span><span class="op">)</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"color"</span>, type <span class="op">=</span> <span class="st">"lower"</span>, col.lim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  is.corr <span class="op">=</span> <span class="cn">FALSE</span>, title <span class="op">=</span> <span class="st">"Classic (father removed)"</span>,</span>
<span>  order <span class="op">=</span> <span class="st">"hclust"</span>,</span>
<span>  tl.pos <span class="op">=</span> <span class="st">"l"</span>, tl.col <span class="op">=</span> <span class="st">"black"</span>, tl.srt <span class="op">=</span> <span class="fl">5</span>, tl.cex <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/COL1.html" class="external-link">COL1</a></span><span class="op">(</span><span class="st">"Reds"</span>, <span class="fl">100</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="v3_analyticrelatedness_files/figure-html/unnamed-chunk-16-1.png" class="r-plt" alt="" width="700"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html" class="external-link">corrplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">ped_add_partial_dad</span><span class="op">)</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"color"</span>, type <span class="op">=</span> <span class="st">"lower"</span>, col.lim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  is.corr <span class="op">=</span> <span class="cn">FALSE</span>, title <span class="op">=</span> <span class="st">"Partial (father removed)"</span>,</span>
<span>  order <span class="op">=</span> <span class="st">"hclust"</span>,</span>
<span>  tl.pos <span class="op">=</span> <span class="st">"l"</span>, tl.col <span class="op">=</span> <span class="st">"black"</span>, tl.srt <span class="op">=</span> <span class="fl">5</span>, tl.cex <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/COL1.html" class="external-link">COL1</a></span><span class="op">(</span><span class="st">"Reds"</span>, <span class="fl">100</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="v3_analyticrelatedness_files/figure-html/unnamed-chunk-16-2.png" class="r-plt" alt="" width="700"></p>
<p>Again, we compare to the true matrix from the complete pedigree:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html" class="external-link">corrplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">ped_add_classic_complete</span> <span class="op">-</span> <span class="va">ped_add_classic</span><span class="op">)</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"color"</span>, type <span class="op">=</span> <span class="st">"lower"</span>, col.lim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  is.corr <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  order <span class="op">=</span> <span class="st">"hclust"</span>,</span>
<span>  tl.pos <span class="op">=</span> <span class="st">"l"</span>, tl.col <span class="op">=</span> <span class="st">"black"</span>, tl.srt <span class="op">=</span> <span class="fl">5</span>, tl.cex <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/COL1.html" class="external-link">COL1</a></span><span class="op">(</span><span class="st">"Reds"</span>, <span class="fl">100</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="v3_analyticrelatedness_files/figure-html/unnamed-chunk-17-1.png" class="r-plt" alt="" width="700"></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">ped_add_classic_complete</span> <span class="op">-</span> <span class="va">ped_add_classic</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.02991371</span></span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html" class="external-link">corrplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">ped_add_classic_complete</span> <span class="op">-</span> <span class="va">ped_add_partial</span><span class="op">)</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"color"</span>, type <span class="op">=</span> <span class="st">"lower"</span>, col.lim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  is.corr <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  order <span class="op">=</span> <span class="st">"hclust"</span>,</span>
<span>  tl.pos <span class="op">=</span> <span class="st">"l"</span>, tl.col <span class="op">=</span> <span class="st">"black"</span>, tl.srt <span class="op">=</span> <span class="fl">5</span>, tl.cex <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/COL1.html" class="external-link">COL1</a></span><span class="op">(</span><span class="st">"Reds"</span>, <span class="fl">100</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="v3_analyticrelatedness_files/figure-html/unnamed-chunk-18-1.png" class="r-plt" alt="" width="700"></p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">ped_add_classic_complete</span> <span class="op">-</span> <span class="va">ped_add_partial</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.02825904</span></span></code></pre></div>
<p>The partial parent method again yields a matrix closer to the
full-data version.</p>
</div>
</div>
<div class="section level3">
<h3 id="inbreeding-dataset-family-level-evaluation">Inbreeding Dataset: Family-Level Evaluation<a class="anchor" aria-label="anchor" href="#inbreeding-dataset-family-level-evaluation"></a>
</h3>
<p>To generalize the comparison across a larger and more varied set of
pedigrees, we use the <code>inbreeding</code> dataset. Each family in
this dataset is analyzed independently.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"inbreeding"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">inbreeding</span></span>
<span></span>
<span><span class="va">famIDs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">famID</span><span class="op">)</span></span></code></pre></div>
<p>For each one, we construct the additive relationship matrix under
complete information and then simulate two missingness scenarios:</p>
<ul>
<li><p>Missing mother: One individual with a known mother is randomly
selected, and the mother‚Äôs ID is set to NA.</p></li>
<li><p>Missing father: Similarly, one individual with a known father is
selected, and the father‚Äôs ID is set to NA.</p></li>
</ul>
<p>In each condition, we recompute the additive matrix using both the
classic and partial parent methods. We then calculate the RMSE between
each estimate and the matrix from the complete pedigree. This allows us
to quantify which method more accurately reconstructs the original
relatedness structure when parental data are partially missing.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inbreeding_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  famIDs <span class="op">=</span> <span class="va">famIDs</span>,</span>
<span>  RMSE_partial_dad <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">famIDs</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  RMSE_partial_mom <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">famIDs</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  RMSE_classic_dad <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">famIDs</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  RMSE_classic_mom <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">famIDs</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  max_R_classic_dad <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">famIDs</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  max_R_partial_dad <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">famIDs</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  max_R_classic_mom <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">famIDs</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  max_R_partial_mom <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">famIDs</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  max_R_classic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">famIDs</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The loop below performs this procedure for all families in the
dataset and stores both the RMSEs and the maximum relatedness
values.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">famIDs</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># make three versions to filter down</span></span>
<span>  <span class="va">df_fam_dad</span> <span class="op">&lt;-</span> <span class="va">df_fam_mom</span> <span class="op">&lt;-</span> <span class="va">df_fam</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">famID</span> <span class="op">==</span> <span class="va">famIDs</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="op">]</span></span>
<span></span>
<span>  <span class="va">results</span><span class="op">$</span><span class="va">RMSE_partial_mom</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">ped_add_classic_complete</span> <span class="op">-</span> <span class="va">ped_add_partial_mom</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span>  <span class="va">ped_add_partial_complete</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ped2com.html">ped2com</a></span><span class="op">(</span><span class="va">df_fam</span>,</span>
<span>    isChild_method <span class="op">=</span> <span class="st">"partialparent"</span>,</span>
<span>    component <span class="op">=</span> <span class="st">"additive"</span>,</span>
<span>    adjacency_method <span class="op">=</span> <span class="st">"direct"</span>,</span>
<span>    sparse <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="va">ped_add_classic_complete</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ped2com.html">ped2com</a></span><span class="op">(</span><span class="va">df_fam</span>,</span>
<span>    isChild_method <span class="op">=</span> <span class="st">"classic"</span>,</span>
<span>    component <span class="op">=</span> <span class="st">"additive"</span>,</span>
<span>    adjacency_method <span class="op">=</span> <span class="st">"direct"</span>,</span>
<span>    sparse <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span></span>
<span>  <span class="co"># select first ID with a mom and dad</span></span>
<span>  <span class="va">momid_to_cut</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df_fam</span><span class="op">$</span><span class="va">ID</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">df_fam</span><span class="op">$</span><span class="va">momID</span><span class="op">)</span><span class="op">]</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">dadid_to_cut</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df_fam</span><span class="op">$</span><span class="va">ID</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">df_fam</span><span class="op">$</span><span class="va">dadID</span><span class="op">)</span><span class="op">]</span>, <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">df_fam_dad</span><span class="op">$</span><span class="va">dadID</span><span class="op">[</span><span class="va">df_fam</span><span class="op">$</span><span class="va">ID</span> <span class="op">==</span> <span class="va">dadid_to_cut</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span></span>
<span>  <span class="va">df_fam_mom</span><span class="op">$</span><span class="va">momID</span><span class="op">[</span><span class="va">df_fam</span><span class="op">$</span><span class="va">ID</span> <span class="op">==</span> <span class="va">momid_to_cut</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span></span>
<span>  <span class="va">ped_add_partial_dad</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ped2com.html">ped2com</a></span><span class="op">(</span><span class="va">df_fam_dad</span>,</span>
<span>    isChild_method <span class="op">=</span> <span class="st">"partialparent"</span>,</span>
<span>    component <span class="op">=</span> <span class="st">"additive"</span>,</span>
<span>    adjacency_method <span class="op">=</span> <span class="st">"direct"</span>,</span>
<span>    sparse <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">ped_add_classic_dad</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ped2com.html">ped2com</a></span><span class="op">(</span><span class="va">df_fam_dad</span>,</span>
<span>    isChild_method <span class="op">=</span> <span class="st">"classic"</span>,</span>
<span>    component <span class="op">=</span> <span class="st">"additive"</span>, adjacency_method <span class="op">=</span> <span class="st">"direct"</span>,</span>
<span>    sparse <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="va">results</span><span class="op">$</span><span class="va">RMSE_partial_dad</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">ped_add_classic_complete</span> <span class="op">-</span> <span class="va">ped_add_partial_dad</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">results</span><span class="op">$</span><span class="va">RMSE_classic_dad</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">ped_add_classic_complete</span> <span class="op">-</span> <span class="va">ped_add_classic_dad</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">results</span><span class="op">$</span><span class="va">max_R_classic_dad</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">ped_add_classic_dad</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">results</span><span class="op">$</span><span class="va">max_R_partial_dad</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">ped_add_partial_dad</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span>  <span class="va">ped_add_partial_mom</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ped2com.html">ped2com</a></span><span class="op">(</span><span class="va">df_fam_mom</span>,</span>
<span>    isChild_method <span class="op">=</span> <span class="st">"partialparent"</span>,</span>
<span>    component <span class="op">=</span> <span class="st">"additive"</span>,</span>
<span>    adjacency_method <span class="op">=</span> <span class="st">"direct"</span>,</span>
<span>    sparse <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="va">ped_add_classic_mom</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ped2com.html">ped2com</a></span><span class="op">(</span><span class="va">df_fam_mom</span>,</span>
<span>    isChild_method <span class="op">=</span> <span class="st">"classic"</span>,</span>
<span>    component <span class="op">=</span> <span class="st">"additive"</span>, adjacency_method <span class="op">=</span> <span class="st">"direct"</span>,</span>
<span>    sparse <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="va">results</span><span class="op">$</span><span class="va">RMSE_partial_mom</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">ped_add_classic_complete</span> <span class="op">-</span> <span class="va">ped_add_partial_mom</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">results</span><span class="op">$</span><span class="va">RMSE_classic_mom</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">ped_add_classic_complete</span> <span class="op">-</span> <span class="va">ped_add_classic_mom</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">results</span><span class="op">$</span><span class="va">max_R_classic_mom</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">ped_add_classic_mom</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">results</span><span class="op">$</span><span class="va">max_R_partial_mom</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">ped_add_partial_mom</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">results</span><span class="op">$</span><span class="va">max_R_classic</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">ped_add_classic_complete</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">inbreeding_list</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    df_fam <span class="op">=</span> <span class="va">df_fam</span>,</span>
<span>    ped_add_partial_complete <span class="op">=</span> <span class="va">ped_add_partial_complete</span>,</span>
<span>    ped_add_classic_complete <span class="op">=</span> <span class="va">ped_add_classic_complete</span>,</span>
<span>    ped_add_partial_dad <span class="op">=</span> <span class="va">ped_add_partial_dad</span>,</span>
<span>    ped_add_classic_dad <span class="op">=</span> <span class="va">ped_add_classic_dad</span>,</span>
<span>    ped_add_partial_mom <span class="op">=</span> <span class="va">ped_add_partial_mom</span>,</span>
<span>    ped_add_classic_mom <span class="op">=</span> <span class="va">ped_add_classic_mom</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; Warning in seq_len(famIDs): first element used of 'length.out' argument</span></span></code></pre></div>
<div class="section level4">
<h4 id="example-family-1">Example: Family <code>1</code><a class="anchor" aria-label="anchor" href="#example-family-1"></a>
</h4>
<p>To understand what these matrices look like, we visualize them for
one representative family. For this example, we select the first family
in the dataset.</p>
<p><img src="v3_analyticrelatedness_files/figure-html/unnamed-chunk-22-1.png" class="r-plt" alt="" width="700"></p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># pull the first family from the list</span></span>
<span><span class="va">fam1</span> <span class="op">&lt;-</span> <span class="va">inbreeding_list</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html" class="external-link">corrplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">fam1</span><span class="op">$</span><span class="va">ped_add_classic_complete</span><span class="op">)</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"color"</span>, type <span class="op">=</span> <span class="st">"lower"</span>, col.lim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  is.corr <span class="op">=</span> <span class="cn">FALSE</span>, title <span class="op">=</span> <span class="st">"Classic - Complete"</span>,</span>
<span>  order <span class="op">=</span> <span class="st">"hclust"</span>,</span>
<span>  tl.pos <span class="op">=</span> <span class="st">"l"</span>, tl.col <span class="op">=</span> <span class="st">"black"</span>, tl.srt <span class="op">=</span> <span class="fl">5</span>, tl.cex <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/COL1.html" class="external-link">COL1</a></span><span class="op">(</span><span class="st">"Reds"</span>, <span class="fl">100</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="v3_analyticrelatedness_files/figure-html/unnamed-chunk-23-1.png" class="r-plt" alt="" width="700"></p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html" class="external-link">corrplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">fam1</span><span class="op">$</span><span class="va">ped_add_classic_mom</span><span class="op">)</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"color"</span>, type <span class="op">=</span> <span class="st">"lower"</span>, col.lim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  is.corr <span class="op">=</span> <span class="cn">FALSE</span>, title <span class="op">=</span> <span class="st">"Classic - Mom Missing"</span>,</span>
<span>  order <span class="op">=</span> <span class="st">"hclust"</span>,</span>
<span>  tl.pos <span class="op">=</span> <span class="st">"l"</span>, tl.col <span class="op">=</span> <span class="st">"black"</span>, tl.srt <span class="op">=</span> <span class="fl">5</span>, tl.cex <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/COL1.html" class="external-link">COL1</a></span><span class="op">(</span><span class="st">"Reds"</span>, <span class="fl">100</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="v3_analyticrelatedness_files/figure-html/unnamed-chunk-23-2.png" class="r-plt" alt="" width="700"></p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html" class="external-link">corrplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">fam1</span><span class="op">$</span><span class="va">ped_add_partial_mom</span><span class="op">)</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"color"</span>, type <span class="op">=</span> <span class="st">"lower"</span>, col.lim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  is.corr <span class="op">=</span> <span class="cn">FALSE</span>, title <span class="op">=</span> <span class="st">"Partial - Mom Missing"</span>,</span>
<span>  order <span class="op">=</span> <span class="st">"hclust"</span>,</span>
<span>  tl.pos <span class="op">=</span> <span class="st">"l"</span>, tl.col <span class="op">=</span> <span class="st">"black"</span>, tl.srt <span class="op">=</span> <span class="fl">5</span>, tl.cex <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/COL1.html" class="external-link">COL1</a></span><span class="op">(</span><span class="st">"Reds"</span>, <span class="fl">100</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="v3_analyticrelatedness_files/figure-html/unnamed-chunk-23-3.png" class="r-plt" alt="" width="700"></p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html" class="external-link">corrplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">fam1</span><span class="op">$</span><span class="va">ped_add_classic_dad</span><span class="op">)</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"color"</span>, type <span class="op">=</span> <span class="st">"lower"</span>, col.lim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  is.corr <span class="op">=</span> <span class="cn">FALSE</span>, title <span class="op">=</span> <span class="st">"Classic - Dad Missing"</span>,</span>
<span>  order <span class="op">=</span> <span class="st">"hclust"</span>,</span>
<span>  tl.pos <span class="op">=</span> <span class="st">"l"</span>, tl.col <span class="op">=</span> <span class="st">"black"</span>, tl.srt <span class="op">=</span> <span class="fl">5</span>, tl.cex <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/COL1.html" class="external-link">COL1</a></span><span class="op">(</span><span class="st">"Reds"</span>, <span class="fl">100</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="v3_analyticrelatedness_files/figure-html/unnamed-chunk-23-4.png" class="r-plt" alt="" width="700"></p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html" class="external-link">corrplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">fam1</span><span class="op">$</span><span class="va">ped_add_partial_dad</span><span class="op">)</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"color"</span>, type <span class="op">=</span> <span class="st">"lower"</span>, col.lim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  is.corr <span class="op">=</span> <span class="cn">FALSE</span>, title <span class="op">=</span> <span class="st">"Partial - Dad Missing"</span>,</span>
<span>  order <span class="op">=</span> <span class="st">"hclust"</span>,</span>
<span>  tl.pos <span class="op">=</span> <span class="st">"l"</span>, tl.col <span class="op">=</span> <span class="st">"black"</span>, tl.srt <span class="op">=</span> <span class="fl">5</span>, tl.cex <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/COL1.html" class="external-link">COL1</a></span><span class="op">(</span><span class="st">"Reds"</span>, <span class="fl">100</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="v3_analyticrelatedness_files/figure-html/unnamed-chunk-23-5.png" class="r-plt" alt="" width="700"></p>
<p>To visualize the differences from the true matrix:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html" class="external-link">corrplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">fam1</span><span class="op">$</span><span class="va">ped_add_classic_complete</span> <span class="op">-</span> <span class="va">fam1</span><span class="op">$</span><span class="va">ped_add_classic_mom</span><span class="op">)</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"color"</span>, type <span class="op">=</span> <span class="st">"lower"</span>, col.lim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  is.corr <span class="op">=</span> <span class="cn">FALSE</span>, title <span class="op">=</span> <span class="st">"Classic Mom Diff from Complete"</span>,</span>
<span>  order <span class="op">=</span> <span class="st">"hclust"</span>,</span>
<span>  tl.pos <span class="op">=</span> <span class="st">"l"</span>, tl.col <span class="op">=</span> <span class="st">"black"</span>, tl.srt <span class="op">=</span> <span class="fl">5</span>, tl.cex <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/COL1.html" class="external-link">COL1</a></span><span class="op">(</span><span class="st">"Reds"</span>, <span class="fl">100</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="v3_analyticrelatedness_files/figure-html/unnamed-chunk-24-1.png" class="r-plt" alt="" width="700"></p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html" class="external-link">corrplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">fam1</span><span class="op">$</span><span class="va">ped_add_classic_complete</span> <span class="op">-</span> <span class="va">fam1</span><span class="op">$</span><span class="va">ped_add_partial_mom</span><span class="op">)</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"color"</span>, type <span class="op">=</span> <span class="st">"lower"</span>, col.lim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  is.corr <span class="op">=</span> <span class="cn">FALSE</span>, title <span class="op">=</span> <span class="st">"Partial Mom Diff from Complete"</span>,</span>
<span>  order <span class="op">=</span> <span class="st">"hclust"</span>,</span>
<span>  tl.pos <span class="op">=</span> <span class="st">"l"</span>, tl.col <span class="op">=</span> <span class="st">"black"</span>, tl.srt <span class="op">=</span> <span class="fl">5</span>, tl.cex <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/COL1.html" class="external-link">COL1</a></span><span class="op">(</span><span class="st">"Reds"</span>, <span class="fl">100</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="v3_analyticrelatedness_files/figure-html/unnamed-chunk-24-2.png" class="r-plt" alt="" width="700"></p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html" class="external-link">corrplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">fam1</span><span class="op">$</span><span class="va">ped_add_classic_complete</span> <span class="op">-</span> <span class="va">fam1</span><span class="op">$</span><span class="va">ped_add_classic_dad</span><span class="op">)</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"color"</span>, type <span class="op">=</span> <span class="st">"lower"</span>, col.lim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  is.corr <span class="op">=</span> <span class="cn">FALSE</span>, title <span class="op">=</span> <span class="st">"Classic Dad Diff from Complete"</span>,</span>
<span>  order <span class="op">=</span> <span class="st">"hclust"</span>,</span>
<span>  tl.pos <span class="op">=</span> <span class="st">"l"</span>, tl.col <span class="op">=</span> <span class="st">"black"</span>, tl.srt <span class="op">=</span> <span class="fl">5</span>, tl.cex <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/COL1.html" class="external-link">COL1</a></span><span class="op">(</span><span class="st">"Reds"</span>, <span class="fl">100</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="v3_analyticrelatedness_files/figure-html/unnamed-chunk-24-3.png" class="r-plt" alt="" width="700"></p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html" class="external-link">corrplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">fam1</span><span class="op">$</span><span class="va">ped_add_classic_complete</span> <span class="op">-</span> <span class="va">fam1</span><span class="op">$</span><span class="va">ped_add_partial_dad</span><span class="op">)</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"color"</span>, type <span class="op">=</span> <span class="st">"lower"</span>, col.lim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  is.corr <span class="op">=</span> <span class="cn">FALSE</span>, title <span class="op">=</span> <span class="st">"Partial Dad Diff from Complete"</span>,</span>
<span>  order <span class="op">=</span> <span class="st">"hclust"</span>,</span>
<span>  tl.pos <span class="op">=</span> <span class="st">"l"</span>, tl.col <span class="op">=</span> <span class="st">"black"</span>, tl.srt <span class="op">=</span> <span class="fl">5</span>, tl.cex <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/COL1.html" class="external-link">COL1</a></span><span class="op">(</span><span class="st">"Reds"</span>, <span class="fl">100</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="v3_analyticrelatedness_files/figure-html/unnamed-chunk-24-4.png" class="r-plt" alt="" width="700"></p>
<p>These plots show how each method responds to missing data, and
whether it maintains consistency with the complete pedigree. We observe
that the partial parent method typically introduces smaller deviations.
If desired, this same diagnostic can be repeated for additional
families, such as inbreeding_list[[2]].</p>
</div>
</div>
<div class="section level3">
<h3 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h3>
<p>Across all families in the inbreeding dataset, the results show a
consistent pattern: the partial parent method outperforms the classic
method in reconstructing the additive genetic relationship matrix when
either a mother or a father is missing.</p>
<p>To make this explicit, we calculate the RMSE difference between
methods. A positive value means that the partial method had lower RMSE
(i.e., better accuracy) than the classic method:</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span></span>
<span></span>
<span><span class="va">results</span><span class="op">$</span><span class="va">RMSE_diff_dad</span> <span class="op">&lt;-</span> <span class="va">results</span><span class="op">$</span><span class="va">RMSE_classic_dad</span> <span class="op">-</span> <span class="va">results</span><span class="op">$</span><span class="va">RMSE_partial_dad</span></span>
<span><span class="va">results</span><span class="op">$</span><span class="va">RMSE_diff_mom</span> <span class="op">&lt;-</span> <span class="va">results</span><span class="op">$</span><span class="va">RMSE_classic_mom</span> <span class="op">-</span> <span class="va">results</span><span class="op">$</span><span class="va">RMSE_partial_mom</span></span></code></pre></div>
<p>We can then summarize the pattern across families:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">results</span>, <span class="va">RMSE_diff_mom</span>, <span class="va">RMSE_diff_dad</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;  RMSE_diff_mom      RMSE_diff_dad     </span></span>
<span><span class="co">#&gt;  Min.   :0.002127   Min.   :0.002127  </span></span>
<span><span class="co">#&gt;  1st Qu.:0.002127   1st Qu.:0.002127  </span></span>
<span><span class="co">#&gt;  Median :0.002127   Median :0.002127  </span></span>
<span><span class="co">#&gt;  Mean   :0.002127   Mean   :0.002127  </span></span>
<span><span class="co">#&gt;  3rd Qu.:0.002127   3rd Qu.:0.002127  </span></span>
<span><span class="co">#&gt;  Max.   :0.002127   Max.   :0.002127  </span></span>
<span><span class="co">#&gt;  NA's   :7          NA's   :7</span></span></code></pre></div>
<p>In all families, both <code>RMSE_diff_mom</code> and
<code>RMSE_diff_dad</code> are positive‚Äîindicating that the classic
method produces larger the errors relative to the partial method. This
holds regardless of whether the missing parent is a mother or a
father.</p>
<p>To verify this directly:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">RMSE_diff_mom</span> <span class="op">&gt;</span> <span class="fl">0</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">RMSE_diff_dad</span> <span class="op">&gt;</span> <span class="fl">0</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1</span></span></code></pre></div>
<p>These proportions show how often the partial method produces a lower
RMSE across the dataset. This confirms the earlier findings: when
pedigree data are incomplete, the partial parent method more faithfully
reconstructs the full-data relatedness matrix.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span></span>
<span>    <span class="op">-</span><span class="va">famIDs</span>, <span class="op">-</span><span class="va">RMSE_diff_mom</span>, <span class="op">-</span><span class="va">RMSE_diff_dad</span>, <span class="op">-</span><span class="va">max_R_classic_dad</span>,</span>
<span>    <span class="op">-</span><span class="va">max_R_partial_dad</span>, <span class="op">-</span><span class="va">max_R_classic_mom</span>, <span class="op">-</span><span class="va">max_R_partial_mom</span>, <span class="op">-</span><span class="va">max_R_classic</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;  RMSE_partial_dad  RMSE_partial_mom  RMSE_classic_dad  RMSE_classic_mom </span></span>
<span><span class="co">#&gt;  Min.   :0.05634   Min.   :0.05634   Min.   :0.05846   Min.   :0.05846  </span></span>
<span><span class="co">#&gt;  1st Qu.:0.05634   1st Qu.:0.05634   1st Qu.:0.05846   1st Qu.:0.05846  </span></span>
<span><span class="co">#&gt;  Median :0.05634   Median :0.05634   Median :0.05846   Median :0.05846  </span></span>
<span><span class="co">#&gt;  Mean   :0.05634   Mean   :0.05634   Mean   :0.05846   Mean   :0.05846  </span></span>
<span><span class="co">#&gt;  3rd Qu.:0.05634   3rd Qu.:0.05634   3rd Qu.:0.05846   3rd Qu.:0.05846  </span></span>
<span><span class="co">#&gt;  Max.   :0.05634   Max.   :0.05634   Max.   :0.05846   Max.   :0.05846  </span></span>
<span><span class="co">#&gt;  NA's   :7         NA's   :7         NA's   :7         NA's   :7</span></span></code></pre></div>
<p>This summary provides an overview of the RMSE values for each method
across families. The advantage of the partial parent method in
reconstructing relatedness was consistent when parental data are
missing.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by S. Mason Garrison, Michael D. Hunter, Xuanyu Lyu, Jonathan D. Trattner, S. Alexandra Burt.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>

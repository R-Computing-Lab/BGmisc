---
title: "Pedigree Simulation and Visualization with BGmisc"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Pedigree}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
options(rmarkdown.html_vignette.check_title = FALSE) 
```


# Introduction

This vignette provides a detailed guide to the pedigree-related functions within the `BGmisc` package. 

## Loading Required Libraries

```{r setup}
library(BGmisc)
```

# Simulating Pedigree



Unlike Tolstoy, where only happy families are alike, all pedigrees are alike. Moreover, such pedigrees can be simulated as a function of several parameters, including the number of children per mate, generations, sex ratio of newborns, and mating rate 

The simulation function provides users the opportunity to test family models in pedigrees with a customized pedigree length and width. Since data in the form of large family pedigrees is difficult to collect or access, simulated pedigrees serve as an efficient tool for building statistical models using family data and evaluating the statistical properties of the model, such as power, bias, and computational efficiency. 

For example, a pedigree that follows these conditions: There are a total of four generations in which each mating produces four offspring. The number of male and female newborns is equal. 70% of individuals mate and bear offspring. Such a pedigree structure can be simulated by running:

```{r}
set.seed(5)
Ped <- SimPed(kpc = 4, Ngen = 4, sexR = .5, marR = .7)

summary(Ped)
```

The simulation output is a `data.frame` with `r length(Ped$ID)` rows and `r length(Ped)` columns. Each row corresponds to a simulated individual.

```{r}
Ped[21,]
```

The columns represents the individual's family ID, the individual's personal ID, the generation the individual is in, the IDs of their father and mother, the ID of their spouse, and the biological sex of the individual, respectively.

## Plotting Pedigree


Pedigrees are visual diagrams that represent family relationships across generations. They are commonly used in genetics to trace the inheritance of specific traits or conditions. This vignette will guide you through visualizing simulated pedigrees using the `PlotPedigree` function. This function is a wrapper function for Kinship2's base R plotting.

### Single Pedigree Visualization

To visualize a single simulated pedigree, use the `PlotPedigree()` function.

```{r,fig.width=8,fig.height=6}

# Plot the simulated pedigree
PlotPedigree(Ped)

```


In the resulting plot, biological males are represented by squares, while biological females are represented by circles, following the standard pedigree conventions.

### Visualizing Multiple Pedigrees Side-by-Side

If you wish to compare different pedigrees side by side, you can plot them together. For instance, let's visualize pedigrees for families spanning three and four generations, respectively.


```{r,fig.width=8, fig.height=6}
# Simulate a family with 3 generations
df_ped_3 <- SimPed(Ngen = 3)

# Simulate a family with 4 generations
df_ped_4 <- SimPed(Ngen = 4)

# Set up plotting parameters for side-by-side display
par(mfrow=c(1, 2))

# Plot the 3-generation pedigree
PlotPedigree(df_ped_3, width = 3)

# Plot the 4-generation pedigree
PlotPedigree(df_ped_4, width = 1)


```   

By examining the side-by-side plots, you can contrast and analyze the structures of different families, tracing the inheritance of specific traits or conditions if needed.

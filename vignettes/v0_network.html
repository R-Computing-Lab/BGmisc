<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Network tools for finding extended pedigrees and path tracing</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Network tools for finding extended
pedigrees and path tracing</h1>



<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>This vignette showcases two key features that capitalize on the
network structure inherent in pedigrees:</p>
<ol style="list-style-type: decimal">
<li><p>Finding extended families with <em>any</em> connecting
relationships between members. This feature strictly uses a person’s ID,
mother’s ID, and father’s ID to find out which people in a dataset are
remotely related by any path, effectively finding all separable extended
families in a dataset.</p></li>
<li><p>Using path tracing rules to quantify the <em>amount</em> of
relatedness between all pairs of individuals in a dataset. The amount of
relatedness can be characterized by additive nuclear DNA, shared
mitochondrial DNA, sharing both parents, or being part of the same
extended pedigree.</p></li>
</ol>
<div id="loading-required-libraries-and-data" class="section level2">
<h2>Loading Required Libraries and Data</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(BGmisc)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">data</span>(potter)</span></code></pre></div>
</div>
</div>
<div id="finding-extended-families" class="section level1">
<h1>Finding Extended Families</h1>
<p>Many pedigree datasets only contain information on the person, their
mother, and their father, often without nuclear or extended family IDs.
Recognizing which sets of people are unrelated simplifies many
pedigree-related tasks. This function facilitates those tasks by finding
all the extended families. People within the same extended family have
at least some form of relation, however distant, while those in
different extended families have no relations.</p>
<div class="figure">
<img role="img" aria-label="Potter Family Pedigree" src="data:image/png;base64,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" alt="Potter Family Pedigree" width="50%" />
<p class="caption">
Potter Family Pedigree
</p>
</div>
<p>We will use the <code>potter</code> pedigree data as an example. For
convenience, we’ve renamed the family ID variable to <code>oldfam</code>
to avoid confusion with the new family ID variable we will create.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>df_potter <span class="ot">&lt;-</span> potter</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">names</span>(df_potter)[<span class="fu">names</span>(df_potter) <span class="sc">==</span> <span class="st">&quot;famID&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;oldfam&quot;</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>ds <span class="ot">&lt;-</span> <span class="fu">ped2fam</span>(df_potter, <span class="at">famID =</span> <span class="st">&quot;famID&quot;</span>, <span class="at">personID =</span> <span class="st">&quot;personID&quot;</span>)</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="fu">table</span>(ds<span class="sc">$</span>famID, ds<span class="sc">$</span>oldfam)</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="co">#&gt;    </span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="co">#&gt;      1</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="co">#&gt;   1 36</span></span></code></pre></div>
<p>Because the <code>potter</code> data already had a family ID
variable, we compare our newly created variable to the pre-existing one.
They match!</p>
</div>
<div id="computing-relatedness" class="section level1">
<h1>Computing Relatedness</h1>
<p>Once you know which sets of people are related at all to one another,
you’ll likely want to know how much. For additive genetic relatedness,
you can use the <code>ped2add()</code> function.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>add <span class="ot">&lt;-</span> <span class="fu">ped2add</span>(potter, <span class="at">sparse =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>This computes the additive genetic relatedness for everyone in the
data. It returns a square, symmetric matrix that has as many rows and
columns as there are IDs.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>add[<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>]</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="co">#&gt;     1    2    3    4   5     6     7</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="co">#&gt; 1 1.0 0.50 0.00 0.00 0.0 0.500 0.000</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co">#&gt; 2 0.5 1.00 0.00 0.00 0.0 0.250 0.000</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="co">#&gt; 3 0.0 0.00 1.00 0.50 0.0 0.500 0.250</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co">#&gt; 4 0.0 0.00 0.50 1.00 0.0 0.250 0.500</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="co">#&gt; 5 0.0 0.00 0.00 0.00 1.0 0.000 0.500</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co">#&gt; 6 0.5 0.25 0.50 0.25 0.0 1.000 0.125</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="co">#&gt; 7 0.0 0.00 0.25 0.50 0.5 0.125 1.000</span></span></code></pre></div>
<p>The entry in the ith row and the jth column gives the relatedness
between person i and person j. For example, person 1 (Vernon Dursley)
shares 0.5 of their nuclear DNA with person 6 (Dudley Dursley), shares
0.5 of their nuclear DNA with person 2 (Marjorie Dursley).</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">table</span>(add)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="co">#&gt; add</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co">#&gt;      0 0.0625  0.125   0.25    0.5      1 </span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co">#&gt;    788      6     94    208    164     36</span></span></code></pre></div>
<p>It’s probably fine to do this on the whole dataset when your data
have fewer than 10,000 people. When the data get large, however, it’s
much more efficient to compute this relatedness separately for each
extended family.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>add_list <span class="ot">&lt;-</span> <span class="fu">lapply</span>(</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>  <span class="fu">unique</span>(potter<span class="sc">$</span>famID),</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>  <span class="cf">function</span>(d) {</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>    tmp <span class="ot">&lt;-</span> potter[potter<span class="sc">$</span>famID <span class="sc">%in%</span> d, ]</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>    <span class="fu">ped2add</span>(tmp, <span class="at">sparse =</span> <span class="cn">FALSE</span>)</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>  }</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>)</span></code></pre></div>
<div id="other-relatedness-measures" class="section level2">
<h2>Other relatedness measures</h2>
<p>The function works similarly for mitochondrial
(<code>ped2mit</code>), common nuclear environment through sharing both
parents (<code>ped2cn</code>), and common extended family environment
(<code>ped2ce</code>).</p>
<div id="computing-mitochondrial-relatedness" class="section level3">
<h3>Computing mitochondrial relatedness</h3>
<p>Here we calculate the mitochondrial relatedness between all pairs of
individuals in the <code>potter</code> dataset.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>mit <span class="ot">&lt;-</span> <span class="fu">ped2mit</span>(potter, <span class="at">sparse =</span> <span class="cn">FALSE</span>)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>mit[<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>]</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="co">#&gt;   1 2 3 4 5 6 7</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="co">#&gt; 1 1 1 0 0 0 0 0</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="co">#&gt; 2 1 1 0 0 0 0 0</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co">#&gt; 3 0 0 1 1 0 1 1</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="co">#&gt; 4 0 0 1 1 0 1 1</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="co">#&gt; 5 0 0 0 0 1 0 0</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="co">#&gt; 6 0 0 1 1 0 1 1</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a><span class="co">#&gt; 7 0 0 1 1 0 1 1</span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="fu">table</span>(mit)</span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a><span class="co">#&gt; mit</span></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a><span class="co">#&gt;    0    1 </span></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a><span class="co">#&gt; 1082  214</span></span></code></pre></div>
<p>As you can see, some of the family members share mitochondrial DNA,
such as person 2 and person 3 0, whereas person 1 and person 3 do
not.</p>
</div>
<div id="computing-relatedness-through-common-nuclear-environment" class="section level3">
<h3>Computing relatedness through common nuclear environment</h3>
<p>Here we calculate the relatedness between all pairs of individuals in
the <code>potter</code> dataset through sharing both parents.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>commonNuclear <span class="ot">&lt;-</span> <span class="fu">ped2cn</span>(potter, <span class="at">sparse =</span> <span class="cn">FALSE</span>)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>commonNuclear[<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>]</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="co">#&gt;   1 2 3 4 5 6 7</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="co">#&gt; 1 1 1 0 0 0 0 0</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="co">#&gt; 2 1 1 0 0 0 0 0</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="co">#&gt; 3 0 0 1 1 0 0 0</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="co">#&gt; 4 0 0 1 1 0 0 0</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="co">#&gt; 5 0 0 0 0 1 0 0</span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="co">#&gt; 6 0 0 0 0 0 1 0</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="co">#&gt; 7 0 0 0 0 0 0 1</span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a><span class="fu">table</span>(commonNuclear)</span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a><span class="co">#&gt; commonNuclear</span></span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a><span class="co">#&gt;    0    1 </span></span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a><span class="co">#&gt; 1196  100</span></span></code></pre></div>
</div>
<div id="computing-relatedness-through-common-extended-family-environment" class="section level3">
<h3>Computing relatedness through common extended family
environment</h3>
<p>Here we calculate the relatedness between all pairs of individuals in
the <code>potter</code> dataset through sharing an extended family.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>extendedFamilyEnvironment <span class="ot">&lt;-</span> <span class="fu">ped2ce</span>(potter, <span class="at">sparse =</span> <span class="cn">FALSE</span>)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>extendedFamilyEnvironment[<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>]</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5] [,6] [,7]</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="co">#&gt; [1,]    1    1    1    1    1    1    1</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="co">#&gt; [2,]    1    1    1    1    1    1    1</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="co">#&gt; [3,]    1    1    1    1    1    1    1</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="co">#&gt; [4,]    1    1    1    1    1    1    1</span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="co">#&gt; [5,]    1    1    1    1    1    1    1</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="co">#&gt; [6,]    1    1    1    1    1    1    1</span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a><span class="co">#&gt; [7,]    1    1    1    1    1    1    1</span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="fu">table</span>(extendedFamilyEnvironment)</span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a><span class="co">#&gt; extendedFamilyEnvironment</span></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a><span class="co">#&gt;    1 </span></span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a><span class="co">#&gt; 1296</span></span></code></pre></div>
</div>
</div>
</div>
<div id="subsetting-pedigrees" class="section level1">
<h1>Subsetting Pedigrees</h1>
<p>Subsetting a pedigree allows researchers to focus on specific family
lines or individuals within a larger dataset. This can be particularly
useful for data validation as well as simplifying complex pedigrees for
visualization. However, subsetting a pedigree can result in the
underestimation of relatedness between individuals. This is because the
subsetted pedigree may not contain all the individuals that connect two
people together. For example, if we were to remove Arthur Weasley
(person 9) and Molly Prewett (person 10) from the <code>potter</code>
dataset, we would lose the connections amongst their children.</p>
<div class="figure">
<img role="img" aria-label="Potter Subset Pedigree" src="data:image/png;base64,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" alt="Potter Subset Pedigree" width="50%" />
<p class="caption">
Potter Subset Pedigree
</p>
</div>
<p>In the plot above, we have removed Arthur Weasley (person 9) and
Molly Prewett (person 10) from the <code>potter</code> dataset. As a
result, the connections between their children are lost.</p>
<p>Similarly, if we remove the children of Vernon Dursley (1) and
Petunia Evans (3) from the <code>potter</code> dataset, we would lose
the connections between the two individuals.</p>
<p>However, this subset does not plot the relationship between spouses
(such as the marriage between Vernon Dursley and Petunia Evans), as
there are not children to connect the two individuals together yet.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>subset_rows <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">31</span><span class="sc">:</span><span class="dv">36</span>)</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>subset_potter <span class="ot">&lt;-</span> potter[subset_rows, ]</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAV1BMVEUAAAAAAGYAZrY6AAA6ADo6AGY6OpA6kNtEAVRmAABmADpmAGZmZjpmtv9/006QOgCQOjqQOmaQ2/+2ZgC2/7a2///bkDrb////tmb/25D//7b//9v///+enIQSAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAE30lEQVR4nO3da1PaXBhG4Yha4llBo0D+/+9sKFAjB9eeybN30Fnrwzu2fb3ZXBzUTGdatfZt1dgHOPcEggSCBIIEggSCBIIEggSCekCPB0XdSN0VtVX6lAWA6m0xa6VPmR2o7hWxV/qUuYHqOlio9CkFWjceUF1HC5U+pUBwyrxA+7ccIFT6lAINAaqGVgQo7ymHPYPoB5WzeAbhT1MjAp3FmzT/uPndKQWCU2YGOodvFBMuWHxzSoHglLmBzuCH1ZRLXqdPmR1o/MsdadcET52yANDYF8xSL5oeP+WwS64/4oLtmHdRoKyfXSiBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggaDAu7i8e2vbj6p6aFdPVTWJuO3Pye3Hw+tPts0U//8EoN7kfDt87LOXNxdv7fJ2trh+ayad0UNL4W33JjcfD68/2S4uI4B6kx+Tvcex99mrl9fujxZ/3lfPs/WvAx6c/uTm48F9OeXq+T4AaO+OnwTa/FFH2M5TXxBpL7HdZOBLbDvZTONeYrtTNqdfYl/vze2Mh0cG6h70eKDdf4999vLzmba4SvBJBNo9eQOBNpPN+i/QoVAi0In3lgOgzXvVv3dALg1o944aCLSbDPwq9v9NGp5Bm69286TH5pd+mf8y6TeKZ/zZhRIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEgiKv4uD//HkIw065PGTlzll6u8NvTc/dlIgmBQIJgWCSYFgUiCYFAgmBYJJgWBSIJgUCCYFgkmBYFIgmBQIJgWCSYFgUiCYFAgmBYJJgWBSIJgUCCYFgkmBYFIgmBQIJgWCSYFgUiCYFAgmBYJJgWBSIJgUCCYFgkmBYFIgmBQIJgWCSYFgUiCYFAgmBYJJgWBSIJgUCCYFgkmBYFIgmBQIJgWCSYFgUiCYFAgmBYJJgWBSIJgUCCYFgkmBYFIgmBQIJgWCSYFgUiCYFAgmBYJJgWBSIJgUCCYFgkmBYFIgmBQIJgWCSYFgUiCYFAgmBYJJgWBSIJgUCCYFgkmBYFIgmBQIJgWCSYFgUiCYFAgmBYJJgWBSIJgUCCYFgkmBYFIgmOz93uNBUTdcd0VtlZ4sAFRvi1krPZkdqO4VsVd6MjdQXYffnbKTAsFkZqC6Dr87hScFgsm8QPu3HHB3Sk8KNARo8L+dfHjTGSZHBMp70z9j0jdpmBQIJv1GESYFgkl/WIVJL3fApBfMYDLDhcvflUCQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQNARoOXdW+xtrJ6qahI72c6r6iF4sm2b6eHvHQItby6CgZpJZxR7dz4m8Y9ju7hMAVq9vIbfcnv8wRlW/BP9+T7pGZThocmx2YS/xJpp2kssB9DydhY92b0NxQot/ryPBrS4yuAT/apt1n/B73CyBNDiOvwp2b1JRz+D2tSvYvFA8+OPzdDN8Lf9VCDrJxAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkEPQXb2lWVRa7LeEAAAAASUVORK5CYII=" width="50%" /></p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
